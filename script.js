"use strict";function _asyncToGenerator(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(o,i){try{var a=r[o](i),c=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}return n("next")})}}var fs=require("fs"),plist=require("bplist-parser"),htmlToText=require("html-to-text"),form=document.getElementById("form"),textViewer=document.getElementById("text-viewer");form.addEventListener("submit",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var t,n,o,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),t=document.getElementById("webarchive-file").files[0]){e.next=5;break}return alert("Please select an iOS webarchive file."),e.abrupt("return");case 5:try{n=fs.readFileSync(t),o=plist.parseBuffer(n),i=o.root.archivedDocument,a=htmlToText.fromString(i,{wordwrap:!1,ignoreImage:!0}),textViewer.textContent=a}catch(e){console.error("An error occurred:",e),alert("An error occurred while decoding the iOS webarchive file.")}case 6:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}());